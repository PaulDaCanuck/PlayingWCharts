---
title: "BasicBar"
author: "Paul Guerra"
date: "March 18, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
library(jsonlite)
library(curl)
library(dplyr)
```
## Pull data from the STC website using the table number (in this case national crop supply and disposition 32100013)
```{r} 
stc_table_num <- "32100013"
stc_pull <- fromJSON(curl(sprintf("https://www150.statcan.gc.ca/t1/wds/rest/getFullTableDownloadCSV/%s/en", stc_table_num)))

temp <- tempfile()
download.file(stc_pull$object, temp)
crop_s_d <- read.csv(unz(temp, "32100013.csv"))
unlink(temp)
rm(stc_pull)

```


# Make sure the data came in
```{r}
colnames(crop_s_d)
dim(crop_s_d)
```
```{r}
crop_s_d_select <- select(crop_s_d, date = REF_DATE, crop = Type.of.crop, s_d = Supply.and.disposition.of.grains,  VALUE)
filter(crop_s_d_select, crop %in% c("All wheat", "Canola") & s_d == "Total ending stocks")
```

